Leak-free walk-forward with on-the-fly feature calculation